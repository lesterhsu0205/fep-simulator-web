server {
    listen 5173;
    server_name localhost;
    root /usr/share/nginx/html;
    index index.html;
    
    # ============================================================
    # ğŸš€ æ–°å¢ï¼šå•Ÿç”¨éœæ…‹å£“ç¸® (Static Compression)
    # é€™è£¡çš„è¨­å®šæ˜¯å…¨åŸŸæœ‰æ•ˆçš„ï¼Œæœƒæ‡‰ç”¨åˆ°ä¸‹é¢çš„æ‰€æœ‰ location
    # ============================================================
    
    # 1. é–‹å•Ÿ Gzip éœæ…‹æ¨¡çµ„ (å„ªå…ˆå‚³é€ .gz æª”)
    # ç•¶ç€è¦½å™¨è«‹æ±‚ xxx.js æ™‚ï¼ŒNginx æœƒå…ˆæª¢æŸ¥æœ‰æ²’æœ‰ xxx.js.gz
    # gzip on;
    gzip_static on;
    gzip_proxied any;
    gzip_types text/plain
               text/css
               text/xml
               text/javascript
               application/json
               application/javascript
               application/x-javascript
               application/xml 
               application/xml+rss
               image/svg+xml;
    gzip_vary on;

    # 2. é–‹å•Ÿ Brotli éœæ…‹æ¨¡çµ„ (å„ªå…ˆå‚³é€ .br æª”)
    # âš ï¸ æ³¨æ„ï¼šé€™éœ€è¦ä½ çš„ Nginx æœ‰å®‰è£ ngx_brotli æ¨¡çµ„
    # å¦‚æœä½ çš„ Docker Image æ˜¯æ¨™æº–ç‰ˆ (nginx:alpine)ï¼Œé€™è¡Œå¯èƒ½æœƒå°è‡´å•Ÿå‹•å¤±æ•—
    # å¦‚æœå ±éŒ¯ï¼Œè«‹æš«æ™‚è¨»è§£æ‰ä¸‹é¢é€™è¡Œï¼Œæˆ–è€…æ”¹ç”¨ fholzer/nginx-brotli ç­‰æ”¯æ´çš„ Image
    # brotli_static on;

    # ============================================================
    
    # è™•ç†æ²’æœ‰çµå°¾æ–œç·šçš„æƒ…æ³ï¼ˆä½¿ç”¨ç›¸å°è·¯å¾‘ï¼‰
    location = /${APP_BASE_PATH} {
        return 302 ./${APP_BASE_PATH}/;
    }
    
    # è™•ç†å­è·¯å¾‘çš„ SPA è·¯ç”±
    location /${APP_BASE_PATH}/ {
        # gzip_static on;
        try_files $uri $uri/ /${APP_BASE_PATH}/index.html;
    }

    # éœæ…‹è³‡æºå¿«å–
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        # æ˜ç¢ºå•Ÿç”¨éœæ…‹ gzipï¼ˆéƒ¨åˆ† nginx ç‰ˆæœ¬åœ¨ location å€å¡Šä¸­éœ€è¦é‡æ–°è²æ˜ï¼‰
        # gzip_static on;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
